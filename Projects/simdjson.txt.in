cmake_minimum_required(VERSION 3.24)
include(ExternalProject)
project(project_simdjson)

set(CMAKE_PREFIX_PATH @CMAKE_PREFIX_PATH@)
set(IMPORT_PROJECT_STATIC_CRT @IMPORT_PROJECT_STATIC_CRT@)

if(IMPORT_PROJECT_STATIC_CRT)
  if(MSVC)
    set(CMAKE_MSVC_RUNTIME_LIBRARY "MultiThreaded$<$<CONFIG:Debug>:Debug>")
  endif()
endif()


ExternalProject_Add(simdjson
  GIT_REPOSITORY @GIT_REPOSITORY@
  GIT_TAG @IMPORT_PROJECT_TAG@
  GIT_SHALLOW @GIT_SHALLOW_VAL@
  CMAKE_ARGS
  -DCMAKE_INSTALL_PREFIX:PATH=<INSTALL_DIR>
  CMAKE_CACHE_ARGS
  -DCMAKE_DEBUG_POSTFIX:STRING=d
  -DCMAKE_PREFIX_PATH:STRING=${CMAKE_PREFIX_PATH}
  -DCMAKE_POLICY_DEFAULT_CMP0091:STRING=NEW
  -DCMAKE_MSVC_RUNTIME_LIBRARY:STRING=${CMAKE_MSVC_RUNTIME_LIBRARY}
  -DBUILD_SHARED_LIBS:BOOL=ON
  -DSIMDJSON_BUILD_STATIC_LIB:BOOL=ON
)
